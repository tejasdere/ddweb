<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User-Specific Datadog Graphs</title>
</head>
<body>
    <div id="graphs-container"></div>
    <div id="monitors"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const graphsContainer = document.getElementById('graphs-container');
            var queryParams = new URLSearchParams(window.location.search);
            var username = queryParams.get('username');
            
            // Implement user authentication logic here

            // Construct embed URLs with specific environment filter
            const graphUrls = [
                `https://app.datadoghq.com/graph/embed?token=299e9bae0841e9a0ecfd1c55c635170f301a6c32ddc6c71e0895a2c870638a47&height=300&width=600&legend=true&var=invoicetocustomerid:${username},invoicetocustomerenvtype:prd`,
                'https://app.datadoghq.com/graph/embed?token=bd4ed294fb7d32d65fda3d98730d09f28d1aaeed63c7f2960b7732f2d7ab3916&height=300&width=600&legend=true&var=invoicetocustomerid:${username},invoicetocustomerenvtype:prd',
                'https://app.datadoghq.com/graph/embed?token=7de9a452e9bab5654f03162f467cabff15406ea2c404c7cd7f2cb380bc90fd48&height=300&width=600&legend=true&var=invoicetocustomerid:${username}'
            ];

            // Inject embed code into container
            graphUrls.forEach(url => {
                const iframe = document.createElement('iframe');
                iframe.src = url;
                iframe.width = '600';
                iframe.height = '300';
                graphsContainer.appendChild(iframe);
            });
            // Datadog API endpoint for monitors
            const apiUrl = 'https://api.datadoghq.com/api/v1/monitor';
            // Perform API request
            fetch(apiUrl, {
              method: 'GET',
              headers: {
                'Content-Type': 'application/json',
                'DD-API-KEY': '805ce94d6887bc6bfee3a3def58fa351',
                'DD-APPLICATION-KEY': 'd0c2fd3acf76b7e7d44e59f851752625ae217801',
              },
            })
            .then(response => response.json())
            .then(data => {
              // Display monitors data on the web page
              const monitorsElement = document.getElementById('monitors');
              monitorsElement.innerHTML = JSON.stringify(data, null, 2);
            })
            .catch(error => console.error('Error fetching monitors:', error));
         });
    </script>
</body>
</html>
